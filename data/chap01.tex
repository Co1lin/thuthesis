% !TeX root = ../thuthesis-example.tex

\chapter{引言}

\section{研究背景}
% 1 page;
% deep learning
近年来，深度学习技术在计算机视觉\cite{diffusion}、自然语言处理\cite{chatgpt}等领域取得了显著成果，普通大众频繁使用智能创作、聊天机器人等基于深度神经网络模型的各种智能服务正在成为现实，深度学习系统效率与安全的重要性日益凸显。

% computation graph & deep learning compilers
深度学习编译器是深度学习系统中的重要组成部分，是将训练完毕的深度学习模型部署到生产环境进行服务的重要工具。如传统编译器在将源代码编译为可执行文件的过程中可以进行常数折叠、死代码消除、循环展开等优化，深度学习编译器可以在将高级语言描述的深度神经网络转换为不同硬件平台对应的底层机器代码的过程中，对深度学习模型的抽象数据结构表示——计算图，做类似的一系列优化，以减少模型的资源占用或提高模型的推理速度。

然而，在部署模型的过程中使用编译器可能带来可靠性风险，因为编译器中计算图构建、图优化、机器代码发射等组件的具体实现中可能存在漏洞。尽管开发者遵循软件工程规范为大量接口实现了单元测试，但手工编写的这些测试丰富度有限，不能尽可能多地暴露深度学习编译器中的全部风险。

% fuzz testing techniques
% fuzz test for deep learning compilers
模糊测试技术是软件工程领域中常用的自动化测试方法。它通过生成并向程序输入大量随机数据，同时监控其运行状态与返回结果，来寻找程序中的漏洞，最早被用于对 Unix 工具的测试。\cite{fuzz_unix}
由于模糊测试可以免除手工构造测例的繁重人力劳动，因此多年以来被用于充分测试各种软件系统以提高它们的可靠性，如浏览器\cite{corbfuzz}、图形渲染引擎\cite{fuzz_graphics}、车载软件系统\cite{fuzz_vehicle}等。近年来，随着深度学习的兴起，研究者开始探索如何对深度学习系统，包括深度学习编译器，进行模糊测试。


\section{研究挑战}
% 1 pages
% valid models as inputs
模糊测试在早期被用于测试 Unix 工具时，仅仅通过生成随机字符串的方式构造测例。\cite{fuzz_unix}然而，这种简单的测例生成算法并不适用于编译器等复杂系统的测试。这是因为，复杂系统的输入往往是遵循某种语法规则的结构化数据，而不合法的输入会导致程序在刚开始解析输入时便报错退出，于是只能测试程序的输入处理部分，而无法触发后续的程序主体。

因此，对深度学习编译器进行模糊测试的首要挑战是生成合法的神经网络。神经网络的合法性可以被分解为两部分：每个算子自身的合法性与算子之间连接的合法性。前者指对于每个算子，其输入，包括张量与其它属性参数，它们的组合应当符合算子本身的定义；后者指相邻算子之间，前一算子的输出张量需要符合后一算子对输入张量的要求，主要是考虑张量的形状。二者共同确保了整个神经网络模型的合法性。

% diverse operator/tensor/attr types
而为了实现充分测试，在模型合法的基础上应尽可能提高模型多样性，从而触发深度学习编译器中尽可能多的优化逻辑。多样性的不同维度及各自的意义至少包含以下几点：（1）算子类型的多样性：深度学习编译器对不同算子、不同的相邻算子组合，有不同的优化实现；（2）张量形状的多样性：不同的输入张量形状对应的最优计算策略不同（如并行策略中的块大小）；（3）属性参数的多样性：很多算子接受非张量输入作为属性参数控制计算行为，如卷积算子中的步长，而不同的属性参数可能对应不同的优化策略。

然而，在合法性约束下，模型多样性与测例生成方法的自动化程度存在矛盾。简单的测例生成方法具有高度的自动化程度，但难以处理合法性约束条件复杂而各不相同的多样算子。引入人工定义的规则可以一一处理多样的算子，但大大降低了生成方法的自动化程度；或需要耗费大量人力，牺牲一定的实用性；或难以自动高效地生成大量测例，降低了整体的多样性。总之，所生成测例的合法性与多样性，以及测试框架的自动化程度，共同对深度学习编译器的模糊测试构成了挑战。而现有工作均不能很好地在三者之间寻求平衡，因此存在较大改进空间。

\section{本文工作}
% 1 paragraph
针对上述问题与挑战，本文首先将在接下来的第 \ref{chp:bg} 章介绍相关工作，并分析各自的权衡取舍与得失，为提出改进策略提供参考基础。
其次，第 \ref{chp:method} 章将介绍一种新的神经网络模糊测试用例生成方法，包括基于插桩的具体算子数据集的构建，与混合算子计算图的生成。
然后，第 \ref{chp:eng} 章将介绍一项工程性贡献，即图结构中间表示与可读代码的相互转换，它可以暴露更多漏洞、提高测试有效性、并丰富测例来源。
第 \ref{chp:exp} 章将通过实验对本文方法进行评测，并展示测试过程中寻找到的典型漏洞，做简要的症候与根因分析，从而直观呈现深度学习编译器中的实现漏洞，体现通过模糊测试寻找漏洞的意义。
最后，第 \ref{chp:sum} 章将对全文进行总结。

